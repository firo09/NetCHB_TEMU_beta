<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>NETChb TEMU beta</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Choices.js for beautiful dropdowns --><style>
    .dropzone:hover, .dropzone.dragover { background-color:#f0f9ff; border-color:#60a5fa; }
    .choices { border-radius: 0.75rem; }
    .choices__inner { border-radius: 0.75rem; padding-top:.6rem; padding-bottom:.6rem; }
    .choices__list--dropdown, .choices__list[aria-expanded] { border-radius: 0.75rem; overflow:hidden; box-shadow: 0 8px 20px rgba(0,0,0,.08); }
    .choices.is-focused .choices__inner { box-shadow: 0 0 0 3px rgba(59,130,246, .35); border-color:#93c5fd; }
    .choices__list--dropdown .choices__item--selectable.is-highlighted { background: rgb(243 244 246); }
    .choices[data-type*="select-one"]::after { border: none; width: 0; height: 0; }
    .choices[data-type*="select-one"] .choices__inner { position: relative; }
    .choices[data-type*="select-one"] .choices__inner::after {
      content: ""; position: absolute; right: .75rem; top: 50%; transform: translateY(-50%);
      width: 0; height: 0; border-left:6px solid transparent; border-right:6px solid transparent; border-top:7px solid #94a3b8;
    }
  </style>

  <style>
    /* custom select styles */
    .cs-wrapper { position: relative; }
    .cs-button {
      display:flex; align-items:center; justify-content:space-between;
      width:100%; padding:10px 12px; border:1px solid #cbd5e1; border-radius:12px; 
      background:#fff; box-shadow: 0 1px 2px rgba(0,0,0,.04);
    }
    .cs-button:focus { outline: none; box-shadow: 0 0 0 3px rgba(59,130,246,.35); border-color:#60a5fa; }
    .cs-menu {
      position:absolute; top:calc(100% + 6px); left:0; right:0; 
      background:#fff; border:1px solid #e5e7eb; border-radius:12px;
      box-shadow: 0 10px 16px rgba(0,0,0,.08); max-height: 240px; overflow:auto; z-index: 50;
      display:none;
    }
    .cs-item { padding:10px 12px; cursor:pointer; }
    .cs-item:hover { background:#f3f4f6; }
    .cs-item[aria-selected="true"] { background:#eef2ff; }
  </style>

  <style>
    /* Custom UI select: always-rounded input and menu */
    .ui-select{position:relative;width:100%}
    .ui-select__btn{width:100%;border:1px solid #d1d5db;border-radius:12px;padding:10px 14px;background:#fff;
      box-shadow:0 1px 2px rgba(16,24,40,.05);display:flex;align-items:center;justify-content:space-between;line-height:1.2}
    .ui-select__btn:focus{outline:0;box-shadow:0 0 0 3px rgba(59,130,246,.28);border-color:rgba(59,130,246,.55)}
    .ui-select__caret{position:absolute;right:12px;top:50%;transform:translateY(-50%);pointer-events:none;opacity:.6}
    .ui-select__menu{position:absolute;z-index:50;left:0;top:calc(100% + 6px);width:100%;max-height:260px;overflow:auto;
      background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 8px 24px rgba(16,24,40,.12);display:none}
    .ui-select.open .ui-select__menu{display:block}
    .ui-option{padding:10px 12px;cursor:pointer}
    .ui-option:hover{background:#f3f4f6}
    .ui-option[aria-selected="true"]{background:#eef2ff}
  </style>

</head>
<body class="bg-gray-100 min-h-screen">


  <!-- 左侧切换（美观版、选中更明显） -->
  <aside id="sidebar" class="fixed left-5 top-8 space-y-3 select-none">
    <a href="./temu.html" aria-current="page" class="block w-56 px-6 py-3 rounded-2xl bg-gradient-to-r from-blue-500 to-blue-600 text-white font-semibold shadow-lg ring-2 ring-blue-300 transform transition-all scale-105">TEMU</a>
    <a href="./shein.html" class="block w-48 px-6 py-3 rounded-2xl bg-white text-emerald-700 border border-emerald-300 font-semibold shadow hover:shadow-md transition-all">SHEIN</a>
  </aside>


  <main class="flex items-center justify-center py-12">
    <div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-3xl">
      <h1 class="text-4xl font-bold text-center text-[#0071bc] mb-8">NETChb TEMU beta</h1>

      <section id="upload-section" class="mb-8">
        <label id="dropzone" for="file-input"
               class="dropzone flex flex-col items-center justify-center border-4 border-dashed border-gray-300 rounded-xl h-48 cursor-pointer transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M3 15a4 4 0 004 4h10a4 4 0 004-4m-4-4l-4-4m0 0L9 11m4-4v12"/>
          </svg>
          <p id="upload-btn" class="text-lg text-gray-600 opacity-50">Click or drag file here</p>
        </label>
        <input type="file" id="file-input" accept=".xlsx,xls,csv" class="hidden"/>
        <p id="loading-msg" class="text-center text-gray-500 mt-2">Loading configuration…</p>

        
        <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-5">
          <div>
            <label class="block text-slate-700 text-sm font-medium mb-1">Port</label>
            <select id="pref-port" class="hidden">
              <option value="">-- Optional --</option>
              <option>JFK</option><option>LAX</option><option>SFO</option><option>ORD</option>
              <option>DFW</option><option>MIA</option><option>ATL</option><option>BOS</option><option>SEA</option>
            </select>
            <div class="ui-select" data-bind="#pref-port"></div>
          </div>
          <div>
            <label class="block text-slate-700 text-sm font-medium mb-1">Date</label>
            <select id="pref-date" class="hidden">
              <option value="">-- Optional --</option>
              <option value="today">Today</option>
              <option value="tomorrow">Tomorrow</option>
            </select>
            <div class="ui-select" data-bind="#pref-date"></div>
          </div>
        </div>

        <button id="continue-btn"
        
                class="mt-6 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed"
                disabled>
          Continue
        </button>
      </section>

      <section id="form-section" class="hidden">
        <form id="dynamic-form" class="grid grid-cols-2 gap-6"></form>
        <button id="generate-btn" type="button"
                class="mt-6 w-full text-white font-semibold py-3 rounded-xl transition"
                style="background-color:#0071bc; border-color:#0071bc;">
          Generate &amp; Download
        </button>
      </section>

      <section id="progress-container" class="hidden mt-8">
        <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden">
          <div id="progress" class="h-4 w-0 transition-all" style="background-color:#0071bc;"></div>
        </div>
        <p id="progress-text" class="text-right text-gray-600 mt-2">0%</p>
      </section>
    </div>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script><script src="app.js"></script>

  <script>
    const dz = document.getElementById('dropzone');
    dz.addEventListener('dragover', function(e){ e.preventDefault(); dz.classList.add('dragover'); });
    dz.addEventListener('dragleave', function(){ dz.classList.remove('dragover'); });
    dz.addEventListener('drop', function(e){ 
      e.preventDefault(); dz.classList.remove('dragover');
      if (e.dataTransfer.files.length) { 
        fileInput.files = e.dataTransfer.files;
        fileInput.dispatchEvent(new Event('change', { bubbles: true }));
      }
    });
  </script>

  <div class="fixed bottom-2 right-2 text-xs text-gray-400 select-none">© Tianyi Z. All rights reserved.</div>

  <script>
    // Custom rounded select component (no external deps)
    function initCustomSelect(selectId, mountId, accent) {
      const select = document.getElementById(selectId);
      const mount = document.getElementById(mountId);
      if (!select || !mount) return;
      // build button
      const wrapper = document.createElement('div');
      wrapper.className = 'relative';
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'w-full rounded-xl border border-slate-300 bg-white px-4 py-2.5 text-left shadow-sm focus:outline-none focus:ring-2 focus:ring-' + accent + '-400 focus:border-' + accent + '-400 transition flex items-center justify-between';
      const label = document.createElement('span');
      label.textContent = select.options[select.selectedIndex]?.text || (select.options[0]?.text || '-- Optional --');
      const chevron = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      chevron.setAttribute('viewBox', '0 0 20 20');
      chevron.setAttribute('fill', 'currentColor');
      chevron.classList.add('h-5','w-5','text-slate-400');
      const p = document.createElementNS('http://www.w3.org/2000/svg','path');
      p.setAttribute('fill-rule','evenodd');
      p.setAttribute('clip-rule','evenodd');
      p.setAttribute('d','M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z');
      chevron.appendChild(p);
      btn.appendChild(label);
      const right = document.createElement('span');
      right.appendChild(chevron);
      btn.appendChild(right);
      // build menu
      const menu = document.createElement('ul');
      menu.className = 'absolute z-30 mt-2 w-full max-h-60 overflow-auto rounded-xl bg-white shadow-lg ring-1 ring-black/5 hidden';
      for (let i=0;i<select.options.length;i++) {
        const opt = select.options[i];
        const li = document.createElement('li');
        li.className = 'px-4 py-2 cursor-pointer hover:bg-slate-100';
        li.textContent = opt.text;
        li.dataset.value = opt.value;
        li.addEventListener('click', () => {
          // set value on hidden select + dispatch change
          select.value = opt.value;
          label.textContent = opt.text;
          const ev = new Event('change', { bubbles: true });
          select.dispatchEvent(ev);
          menu.classList.add('hidden');
          btn.focus();
        });
        menu.appendChild(li);
      }
      btn.addEventListener('click', () => {
        menu.classList.toggle('hidden');
      });
      document.addEventListener('click', (e) => {
        if (!wrapper.contains(e.target)) menu.classList.add('hidden');
      });
      // keyboard basic
      btn.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowDown') { e.preventDefault(); menu.classList.remove('hidden'); menu.querySelector('li')?.focus(); }
      });
      wrapper.appendChild(btn);
      wrapper.appendChild(menu);
      mount.appendChild(wrapper);
    }
    // Init on DOM ready
    document.addEventListener('DOMContentLoaded', function() {
      initCustomSelect('pref-port','cs-pref-port','blue');
      initCustomSelect('pref-date','cs-pref-date','blue');
    });
  </script>


  <script>
    (function(){
      function buildUiSelect(root){
        var sel = document.querySelector(root.getAttribute('data-bind'));
        if(!sel) return;
        // button
        var btn = document.createElement('button');
        btn.type='button'; btn.className='ui-select__btn';
        var label = sel.options[sel.selectedIndex] ? sel.options[sel.selectedIndex].text : (sel.options[0]?.text || '-- Optional --');
        btn.textContent = label;
        root.appendChild(btn);
        // caret
        var caret = document.createElementNS('http://www.w3.org/2000/svg','svg');
        caret.setAttribute('viewBox','0 0 20 20'); caret.setAttribute('width','20'); caret.setAttribute('height','20');
        caret.classList.add('ui-select__caret');
        caret.innerHTML = '<path fill="currentColor" d="M5.3 7.3a1 1 0 0 1 1.4 0L10 10.6l3.3-3.3a1 1 0 1 1 1.4 1.4l-4 4a1 1 0 0 1-1.4 0l-4-4a1 1 0 0 1 0-1.4z"/>';
        root.appendChild(caret);
        // menu
        var menu = document.createElement('div'); menu.className='ui-select__menu';
        Array.prototype.forEach.call(sel.options, function(opt){
          var item = document.createElement('div');
          item.className='ui-option'; item.textContent = opt.text; item.dataset.value = opt.value;
          if(opt.selected) item.setAttribute('aria-selected','true');
          item.addEventListener('click', function(){
            sel.value = opt.value;
            sel.dispatchEvent(new Event('change', {bubbles:true}));
            btn.textContent = opt.text;
            menu.querySelectorAll('.ui-option[aria-selected="true"]').forEach(function(n){ n.removeAttribute('aria-selected'); });
            item.setAttribute('aria-selected','true');
            root.classList.remove('open');
          });
          menu.appendChild(item);
        });
        root.appendChild(menu);
        // toggle
        btn.addEventListener('click', function(){ root.classList.toggle('open'); });
        document.addEventListener('click', function(e){ if(!root.contains(e.target)) root.classList.remove('open'); });
      }
      document.addEventListener('DOMContentLoaded', function(){
        document.querySelectorAll('.ui-select[data-bind]').forEach(buildUiSelect);
      });
    })();
  </script>


<script>
  function alignSidebar() {
    const card = document.querySelector('main > div');   // 白色卡片容器
    const sidebar = document.getElementById('sidebar');
    if (!card || !sidebar) return;
    const top = card.getBoundingClientRect().top + window.scrollY;
    sidebar.style.top = Math.round(top) + 'px';
  }
  window.addEventListener('load', alignSidebar);
  window.addEventListener('resize', alignSidebar);
</script>
</body>

</html>

